# üéØ Experience Builder Integration Guide

## Quick Setup in Experience Builder

### Step 1: Add Embed Widget
1. Open your Experience Builder app
2. From the widget panel, add an **Embed** widget
3. Position it where you want the analysis tool

### Step 2: Configure the Iframe URL
Use your deployed URL with iframe parameters:

```
https://your-app-name.vercel.app?iframe=true&title=Area%20Analysis&basemap=satellite
```

### Step 3: Set Widget Dimensions
- **Width:** 100% (or fixed width like 800px)
- **Height:** Minimum 600px (800px recommended)

### Step 4: Publish
Publish your Experience Builder app and test the embedded tool.

## üé® Common Configurations

### Oil & Gas Infrastructure Analysis
```
https://your-app.vercel.app?iframe=true&title=Oil%20%26%20Gas%20Infrastructure&basemap=satellite&extent=-101,35,6
```

### Environmental Impact Assessment
```
https://your-app.vercel.app?iframe=true&title=Environmental%20Assessment&basemap=topo-vector&extent=-120,45,5
```

### Regional Planning Analysis
```
https://your-app.vercel.app?iframe=true&title=Regional%20Planning&basemap=streets-navigation-vector&extent=-98,39.5,4
```

### Custom Layer Analysis
```
https://your-app.vercel.app?iframe=true&title=Custom%20Analysis&layers=YOUR-LAYER-URL-1,YOUR-LAYER-URL-2
```

## üìè Widget Sizing Guidelines

### Desktop Layouts
- **Minimum Height:** 600px
- **Recommended Height:** 800px
- **Width:** 100% of container

### Mobile Layouts
- **Minimum Height:** 500px
- **Width:** 100% (always responsive)
- **Consider:** Mobile users may need larger touch targets

### Full-Screen Layouts
- **Height:** calc(100vh - header height)
- **Width:** 100vw
- **Position:** Consider making it the main content area

## üîß Advanced Configuration

### Multiple Widget Setup
You can have multiple analysis tools with different configurations:

1. **Widget 1:** Oil & Gas Analysis (with oil/gas layers)
2. **Widget 2:** Environmental Analysis (with environmental layers)
3. **Widget 3:** General Purpose Analysis (with default layers)

### Dynamic Configuration
Use Experience Builder's URL parameters to pass configuration:

```javascript
// Example: Pass region parameter to customize extent
const urlParams = new URLSearchParams(window.location.search);
const region = urlParams.get('region');

let extent = '-98,39.5,4'; // default
if (region === 'texas') extent = '-99,31,6';
if (region === 'california') extent = '-120,37,6';

const iframeUrl = `https://your-app.vercel.app?iframe=true&extent=${extent}`;
```

## üéØ User Experience Tips

### Loading States
- Consider adding a loading message while the iframe initializes
- The tool shows its own loading indicators for map and analysis

### Error Handling
- The embedded tool handles its own errors gracefully
- Users will see friendly error messages for invalid layers or network issues

### Mobile Considerations
- Tool is fully responsive and touch-friendly
- Consider larger height on mobile for better usability
- Test with different device orientations

## üì± Testing Your Integration

### Browser Testing
- [ ] Chrome/Chromium
- [ ] Firefox
- [ ] Safari
- [ ] Edge
- [ ] Mobile browsers

### Functionality Testing
- [ ] Map loads correctly
- [ ] Sketch tool works
- [ ] Analysis runs successfully
- [ ] Downloads work
- [ ] Custom parameters apply correctly

### Experience Builder Specific
- [ ] Widget loads in layout
- [ ] No conflicts with other widgets
- [ ] Responsive behavior works
- [ ] Published app works for external users

## üîç Troubleshooting

### Common Issues

**Iframe doesn't load:**
- Check your deployed URL is accessible
- Verify iframe=true parameter is included
- Check browser console for CORS errors

**Map doesn't appear:**
- Allow time for initial load (3-5 seconds)
- Check internet connection
- Verify ArcGIS services are accessible

**Sketch tool not working:**
- Ensure map is fully loaded before sketching
- Try different basemap if issues persist
- Check for JavaScript errors in console

**Analysis fails:**
- Verify layer URLs are valid and accessible
- Check layer services are online
- Try with default layers first

### Getting Help
- Check browser developer console for error messages
- Test the standalone URL (without Experience Builder) first
- Verify your Vercel deployment is working independently

## üéâ Success Checklist

- [ ] Embed widget added to Experience Builder
- [ ] Iframe URL configured with proper parameters
- [ ] Widget dimensions set appropriately
- [ ] App published and accessible to target users
- [ ] Full workflow tested (sketch ‚Üí analyze ‚Üí download)
- [ ] Works on target devices and browsers
- [ ] External users can access without issues

Your Area Analysis Tool is now fully integrated into Experience Builder! üöÄ